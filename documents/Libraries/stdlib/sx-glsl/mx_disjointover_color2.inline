({{fg}}.w+{{bg}}.w < 1.0) ?
( vec2( {{fg}}.x + {{bg}}.x, min({{fg}}.w + {{bg}}.w, 1.0) ) * {{mix}} :
  vec2( {{fg}}.x + ({{bg}}.x * (1.0-{{fg}}.w)/{{bg}}.w ), min({{fg}}.w + {{bg}}.w, 1.0) ) * {{mix}} )
+ ({{bg}} * (1.0-{{mix}}));
